<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gallery | Meevbrandz</title>
    <link rel="stylesheet" href="/css/styles.css">
    <style>
        .gallery-grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)); 
            gap: 2rem; 
            padding: 2rem 0; 
            max-width: 1400px; 
            margin: 0 auto; 
        }
        .gallery-item { 
            position: relative; 
            border-radius: 16px; 
            overflow: hidden; 
            aspect-ratio: 1; 
            box-shadow: 0 10px 30px rgba(0,0,0,0.15); 
            cursor: pointer; 
            background: #111;
        }
        .gallery-item img { 
            width: 100%; 
            height: 100%; 
            object-fit: cover; 
            transition: transform 0.5s ease;
        }
        .gallery-item:hover img { transform: scale(1.12); }
        .gallery-overlay { 
            position: absolute; bottom: 0; left: 0; right: 0; 
            background: linear-gradient(transparent, rgba(0,0,0,0.9)); 
            color: white; padding: 2rem 1.2rem 1.2rem; 
            transform: translateY(40px); transition: 0.4s;
        }
        .gallery-item:hover .gallery-overlay { transform: translateY(0); }
        .gallery-overlay h3 { margin: 0; font-size: 1.35rem; font-weight: 600; }

        /* Lightbox — Beautiful & Working */
        #lightbox {
            display: none;
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.95);
            backdrop-filter: blur(10px);
            align-items: center;
            justify-content: center;
            z-index: 9999;
            padding: 2rem;
            box-sizing: border-box;
        }
        #lightbox.active { display: flex !important; }
        #lightbox img {
            max-width: 95%;
            max-height: 95vh;
            border-radius: 12px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.8);
            object-fit: contain;
        }
        .lightbox-close {
            position: absolute;
            top: 30px;
            right: 40px;
            font-size: 4rem;
            color: white;
            cursor: pointer;
            font-weight: 300;
            user-select: none;
            transition: 0.3s;
        }
        .lightbox-close:hover { transform: scale(1.2); color: #ff5a5a; }
    </style>
</head>
<body>
    <div class="noise-overlay"></div>

    <nav class="navbar">
        <div class="container nav-container">
            <a href="/" class="logo">Meevbrandz.</a>
            <div class="mobile-menu-btn">☰</div>
            <div class="nav-links">
                <a href="/">Home</a>
                <a href="/about.html">About</a>
                <a href="/gallery.html" class="active">Gallery</a>
                <a href="/testimonials.html">Testimonials</a>
                <a href="/videos.html">Videos</a>
                <a href="/awards.html">Awards</a>
                <a href="/services.html">Services</a>
                <a href="/pricing.html">Pricing</a>
                <a href="/contact.html">Contact</a>
            </div>
        </div>
    </nav>

    <section class="section container" style="padding-top: 150px;">
        <div style="text-align: center; margin-bottom: 3rem;">
            <h1 class="reveal-up">Selected Works.</h1>
            <p class="reveal-up delay-1">A curation of our finest graphic design projects.</p>
        </div>

        <div class="gallery-grid" id="gallery-grid">
            <p style="grid-column: 1/-1; text-align:center; padding:5rem; color:#999;">Loading gallery...</p>
        </div>
    </section>

    <!-- LIGHTBOX -->
    <div id="lightbox">
        <span class="lightbox-close">×</span>
        <img src="" alt="Full view">
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script>
        const supabase = window.supabase.createClient(
            'https://dcwmqnonfruqgrzaqbas.supabase.co',
            'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRjd21xbm9uZnJ1cWdyemFxYmFzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQ1ODc0NjAsImV4cCI6MjA4MDE2MzQ2MH0.vxHW-xZpbVuhjjaK66b5sOQkIHLamEB7KDE8j5eVFN8'
        );

        const grid = document.getElementById('gallery-grid');
        const lightbox = document.getElementById('lightbox');
        const lightboxImg = lightbox.querySelector('img');

        async function loadGallery() {
            const { data } = await supabase.storage.from('portfolio_media').list('');
            const images = data
                .filter(f => /\.(jpe?g|png|gif|webp)$/i.test(f.name))
                .sort((a, b) => (b.created_at || '').localeCompare(a.created_at || ''));

            grid.innerHTML = '';

            if (images.length === 0) {
                grid.innerHTML = '<p style="grid-column:1/-1; padding:6rem; color:#999;">No images uploaded yet.</p>';
                return;
            }

            images.forEach(file => {
                const url = supabase.storage.from('portfolio_media').getPublicUrl(file.name).data.publicUrl;
                const title = file.name.replace(/^\d+_/, '').split('.')[0].replace(/_/g, ' ');

                const item = document.createElement('div');
                item.className = 'gallery-item';
                item.innerHTML = `
                    <img src="${url}" loading="lazy" alt="${title}">
                    <div class="gallery-overlay"><h3>${title}</h3></div>
                `;
                item.onclick = () => {
                    lightboxImg.src = url;
                    lightbox.classList.add('active');
                };
                grid.appendChild(item);
            });
        }

        // Close lightbox
        document.querySelector('.lightbox-close').onclick = () => lightbox.classList.remove('active');
        lightbox.onclick = (e) => { if (e.target === lightbox) lightbox.classList.remove('active'); };
        document.addEventListener('keydown', (e) => e.key === 'Escape' && lightbox.classList.remove('active'));

        loadGallery();
    </script>

    <script src="/js/main.js"></script>
</body>
</html>